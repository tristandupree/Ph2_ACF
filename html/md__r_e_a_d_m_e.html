<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Ph2_DAQ: Git Repository for PH2_DAQ Software</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CMSlogoDoxyfile.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ph2_DAQ
   &#160;<span id="projectnumber">0.3</span>
   </div>
   <div id="projectbrief">Software for DAQ of Ph2 CMSTrackerUpdate</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Git Repository for PH2_DAQ Software </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>&#160;&#160;&#160;&#160;&#160;&#160;<b>Supposed to contain</b></p>
<ul>
<li>A middleware API layer, implemented in C++, which will basically wrap to abstracted functions the firmware calls and handshakes currently hardcoded into DAQ systems software</li>
<li>A C++ object-based library describing the system components (CBCs, Hybrids, Boards) and their properties(values, status)</li>
<li>The MCP test program which is the wrapping the previous two.</li>
</ul>
<h2>Different versions for different setups </h2>
<p>On this GitHub, you can find different version of the software :</p>
<ul>
<li>An agnostic (to the number of CBCs) version with the new structure in the Master branch</li>
<li>A 2CBC version on the 2CBC branch with the previous structure</li>
<li>A 8CBC version on the 8CBC branch with the previous structure</li>
<li>An in-progress version in the dev branch <br/>
 <br/>
 <b>What are the differences between the 2CBC/8CBC versions ?</b></li>
</ul>
<p>The differences mainly resides in the size of the data buffer for the DAQ, when all the access to both Board and Cbc registers is done the same way. Also, some functions are present in 8CBC and not in 2CBC due to the fact that the firmware of the 8CBC is offering more possibilities of recovering infos from the Hardware (as the type of hardware for example)</p>
<h2>The Test Software itself : the MCP Test Interface </h2>
<p>You'll find an install step by step and a How To. <br/>
 <br/>
 &#160;&#160;&#160;&#160;&#160;&#160;<b>Install the MCP Test Interface step by step...</b></p>
<p>Here are the step to make the program functional</p>
<ol type="1">
<li>Recover the GitHub repo with the latest tested version of the MCP.</li>
<li>Change in <a class="el" href="_definition_8h.html">HWDescription/Definition.h</a> the path to the uHal connection file.<ul>
<li>It's per default set to : <a href="file:///afs/cern.ch/user/n/npierre/dev/settings/connections.xml">file:///afs/cern.ch/user/n/npierre/dev/settings/connections.xml</a></li>
<li>You have to change it to : <a href="file://$(BUILD)/settings/connections.xml">file://$(BUILD)/settings/connections.xml</a> (where  is the path to the root of the GitHub repo you recovered)</li>
</ul>
</li>
<li>Change in settings/connections.xml the path to the adress table<ul>
<li>It's per default set to : <a href="file:///afs/cern.ch/user/n/npierre/dev/settings/adress_table">file:///afs/cern.ch/user/n/npierre/dev/settings/adress_table</a>(2CBC or 8CBC).xml</li>
<li>You have to change it to : <a href="file://$(BUILD)/settings/adress_table">file://$(BUILD)/settings/adress_table</a>(2CBC or 8CBC).xml (where  is the path to the root of the GitHub repo you recovered)</li>
</ul>
</li>
<li>Create /lib, /bin and /output directories in the root of the repo.</li>
<li>Do a make in the root the repo (make sure you have all uHal, root, boost... libraries on your computer)</li>
<li>Launch testpgrm command if you want to test if everything is working good.</li>
<li>You can test the data acquisition by lauching datatest2cbc or datatest8cbc.</li>
<li>Launch mcp to play with the Test Interface <br/>
 <br/>
 <b>What can you do with the software ?</b></li>
</ol>
<p>A Glib is created per default (maybe in the future you will be able to play with more than one Glib)</p>
<p>You can then add Modules to the Glib and Cbcs to the Modules you created. When creating a Cbc, you can choose the config file you will load to its register map. If you want to add your personal config file, please make sure to add it in #define in the HWDescription/Description.h and then to add an option in the MCP code.</p>
<p>After this creation round, you can do anything you want :</p>
<ul>
<li>Configure the Glib or the Cbcs</li>
<li>Manipulate the registers in the Glib</li>
<li>Manipulate the registers in the Cbcs</li>
<li>Perform a DAQ and tracing diagrams counting the number of hits</li>
<li>Have a configuration recap of all the objects you created</li>
</ul>
<p>Concerning the manipulation of the Cbcs, you have the opportunity to modify all the Cbcs of a same Module at once with the Broadcast feature of the Cbc.</p>
<p>When you write a register in the Glib or the Cbc, the writing is updated to the map contained in Glib/Cbc objects so that you're always fully aware of what is in the Glib/Cbc register.</p>
<p>For writing value in register, we invite you to put in the following format : 0x__. You must thus type '0xFF' for exemple and not just 'FF' in the command line. That might change in the future..</p>
<p>You can also run DAQ and recover the Hit Histogram for each Cbc and each Event in the output file.</p>
<p>At the end of the program, the register maps are saved into output_X_X.txt files you can find in the settings directory. For example, output_1_2.txt contains the register map of the Cbc 2 of the Module 1. You can also find different .pdf files containing the histograms of the DAQ.</p>
<p>For debugging purpose, you can activate DEV_FLAG in files or in Makefile and also activate the uHal log in <a class="el" href="_reg_manager_8cc.html">RegManager.cc</a>.</p>
<p>More features will be implemented later, so make sure to have the last release locally to benefit from them.</p>
<p>Warning ! : be careful with options choice in the program menus, some mistypes can leed to unexpected hazards :-(.</p>
<h2>On the go... </h2>
<p>&#160;&#160;&#160;&#160;&#160;&#160;<b>Last Updates</b></p>
<ul>
<li>09/07/14 : Added threading for stack writing registers</li>
<li>10/07/14 : Read Data from acquisition in a rubbish format</li>
<li>~~25/07/14 : Fully functional for 2CBC (safe from Broadcast obviously), pending for 8CBC~~</li>
<li>~~28/07/14 : Found a bug in the reading of CBC1 of 2CBC, trying to see if coming from soft or hard~~</li>
<li>30/07/14 : Working 2CBC version, find a 8CBC working version in the 8CBC branch</li>
<li>12/08/14 : Working agnostic version of the new structure on Master</li>
<li>15/08/14 : System Controller Class working <br/>
 <br/>
 <b>Future Improvements</b></li>
<li>Wrap the project nicely</li>
</ul>
<h2>Support, Suggestions ? </h2>
<p>For any support/suggestions, mail Lorenzo Bidegain, Nicolas Pierre or Georg Auzinger. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 17 2014 16:02:22 for Ph2_DAQ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
